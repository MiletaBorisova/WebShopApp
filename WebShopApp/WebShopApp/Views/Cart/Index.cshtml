@model WebShopApp.Infrastructure.Data.Entities.Cart

<div class="container my-5">
    <h2>Моята количка</h2>

    @if (Model.Items == null || !Model.Items.Any())
    {
        <p>Количката е празна.</p>
    }
    else
    {
        <table class="table align-middle">
            <thead>
                <tr>
                    <th></th>
                    <th>Продукт</th>
                    <th>Цена</th>
                    <th>Количество</th>
                    <th>Общо</th>
                    <th></th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.Items)
                {
                    <tr>
                        <td>
                            <img src="@item.Product.Picture"
                                 alt="@item.Product.ProductName"
                                 style="width:80px; height:auto; object-fit:contain;" />
                        </td>

                        <td>
                            <strong>@item.Product.ProductName</strong>
                        </td>

                        <td>
                            @item.Price.ToString("0.00") лв.
                        </td>

                        <td>
                            <div class="d-flex align-items-center gap-2">
                                <a asp-action="DecreaseQuantity"
                                   asp-route-productId="@item.ProductId"
                                   class="btn btn-outline-secondary btn-sm">−</a>

                                <span class="fw-bold">@item.Quantity</span>

                                <a asp-action="IncreaseQuantity"
                                   asp-route-productId="@item.ProductId"
                                   class="btn btn-outline-secondary btn-sm">+</a>
                            </div>
                        </td>

                        <td>
                            <strong>
                                @((item.Price * item.Quantity).ToString("0.00")) лв.
                            </strong>
                        </td>

                        <td>
                            <a asp-action="Remove"
                               asp-route-productId="@item.ProductId"
                               class="btn btn-danger btn-sm">
                                🗑
                            </a>
                        </td>
                    </tr>
                }
            </tbody>
        </table>


        <div class="text-end mt-3">
            <a asp-controller="Order"
               asp-action="CreateFromCart"
               class="btn btn-success btn-lg">
                Потвърди поръчка
            </a>
        </div>

        <div class="text-end mt-4">
            <h4>
                Обща сума:
                <span class="text-success">
                    @((Model.Items.Sum(i => i.Price * i.Quantity)).ToString("0.00")) лв.
                </span>
            </h4>
        </div>


        
    }
</div>
